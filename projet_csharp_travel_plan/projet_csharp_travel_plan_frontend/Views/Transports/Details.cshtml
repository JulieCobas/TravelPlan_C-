@model projet_csharp_travel_plan_frontend.DTO.TransportDTO

@{
    ViewData["Title"] = "Details";
    var voyageId = ViewData["VoyageId"] as int?;
    var categoriesAfficherOptions = new List<string> { "Aérien", "Maritime", "Terrestre - train" };
}

<h1>Details</h1>

<div class="container">
    <div class="card mb-4 shadow-sm">
        <div class="row no-gutters">
            <div class="col-md-4">
                <img src="/img/transport_test.png" class="card-img" alt="Image du transport">
            </div>
            <div class="col-md-8 d-flex flex-column">
                <div class="card-body">
                    <h5 class="card-title">Nom de la compagnie</h5>
                    <p class="card-text">@Model.NomFournisseur</p>
                    @if (categoriesAfficherOptions.Contains(Model.CategorieTransport.Nom))
                    {
                        <p class="card-text">Numéro du siège</p>
                        <div class="form-check">
                            <input class="form-check-input option-checkbox" type="checkbox" id="bagageMain" data-price="@Model.PrixBagageMain" />
                            <label class="form-check-label" for="bagageMain">Bagage à main</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input option-checkbox" type="checkbox" id="bagageEnSoute" data-price="@Model.PrixBagageEnSoute" />
                            <label class="form-check-label" for="bagageEnSoute">Bagage en soute</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input option-checkbox" type="checkbox" id="bagageLarge" data-price="@Model.PrixBagageLarge" />
                            <label class="form-check-label" for="bagageLarge">Bagage large</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input option-checkbox" type="checkbox" id="speedyboarding" data-price="@Model.PrixSpeedyBoarding" />
                            <label class="form-check-label" for="speedyboarding">Speedyboarding</label>
                        </div>
                    }
                    <p class="card-text"><strong>Prix : </strong><span id="totalPrice">@Model.Prix</span> €</p>
                </div>
                <div class="card-footer text-left">
                    <form method="post" asp-action="ConfirmTransportSelection">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="IdTransport" value="@Model.IdTransport" />
                        <input type="hidden" name="BagageMain" value="false" />
                        <input type="hidden" name="BagageEnSoute" value="false" />
                        <input type="hidden" name="BagageLarge" value="false" />
                        <input type="hidden" name="Speedyboarding" value="false" />
                        <input type="hidden" name="voyageId" value="@ViewData["VoyageId"]" />
                        <input type="hidden" name="DateDebut" value="" />
                        <input type="hidden" name="DateFin" value="" />
                        <button type="submit" class="btn btn-primary">Confirmer et passer à la réservation de logement</button>
                    </form>
                    <a href="@Url.Action("Index")" class="btn btn-secondary">Retour à la liste</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const basePrice = parseFloat("@Model.Prix");
        const checkboxes = document.querySelectorAll('.option-checkbox');
        const totalPriceElement = document.getElementById('totalPrice');

        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updatePrice);
        });

        function updatePrice() {
            let totalPrice = basePrice;

            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    totalPrice += parseFloat(checkbox.getAttribute('data-price')) || 0;
                }
            });

            totalPriceElement.textContent = totalPrice.toFixed(2);
        }
    });
</script>

<style>
    .card {
        border-radius: 10px;
        border: none;
    }

    .card-img {
        border-radius: 10px 0 0 10px;
        object-fit: contain;
        height: 200px; /* Fixed height */
        width: 100%; /* Full width */
        border: 2px solid grey;
    }

    .card-title {
        font-weight: bold;
    }

    .card-subtitle {
        font-size: 14px;
        color: #6c757d;
    }

    .card-text {
        margin-bottom: 10px;
    }

    .card-footer {
        background-color: white;
        border-top: none;
        padding: 15px;
    }

    .btn {
        margin-bottom: 10px;
    }

    .fa-star.checked {
        color: orange;
    }

    .container .card:first-child {
        margin-top: 40px;
    }
</style>
