@model IEnumerable<projet_csharp_travel_plan_frontend.DTO.TransportDto>

@{
    ViewData["Title"] = "Index";
    var selectedCategory = ViewData["SelectedCategory"] as string;
}

<h1>Index</h1>
<h1>Liste des Transports</h1>

<form method="get">
    <select name="category" onchange="this.form.submit()">
        <option value="">Sélectionner une catégorie</option>
        <option value="Aérien">Aérien</option>
        <option value="Maritime">Maritime</option>
        <option value="Terrestre - Voiture">Terrestre - Voiture</option>
        <option value="Terrestre - Train">Terrestre - Train</option>
        <option value="Cyclable">Cyclable</option>
    </select>
</form>

@if (!string.IsNullOrEmpty(selectedCategory))
{
    <form method="post" asp-action="ConfirmSelection">
        @Html.AntiForgeryToken()

        <table class="table">
            <thead>
                <tr>
                    @if (selectedCategory == "Aérien" || selectedCategory == "Maritime" || selectedCategory == "Terrestre - Train")
                    {
                        <th>Nom de la compagnie</th>
                        <th>Numéro du siège</th>
                        <th>Bagage à main</th>
                        <th>Bagage en soute</th>
                        <th>Bagage large</th>
                        <th>Speedyboarding</th>
                        <th>Prix</th>
                    }
                    else if (selectedCategory == "Terrestre - Voiture")
                    {
                        <th>Marque</th>
                        <th>Type</th>
                        <th>Nombre de siège</th>
                        <th>Prix</th>
                    }
                    else if (selectedCategory == "Cyclable")
                    {
                        <th>Prix</th>
                    }
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        @if (selectedCategory == "Aérien" || selectedCategory == "Maritime" || selectedCategory == "Terrestre - Train")
                        {
                            <td>@item.FournisseurNomCompagnie</td>
                            <td>@item.OptionTransportNumeroSiege</td>
                            <td>
                                <input type="checkbox" name="options[@item.IdTransport].BagageMain" @(item.OptionTransportBagageMain == true ? "checked" : "") />
                            </td>
                            <td>
                                <input type="checkbox" name="options[@item.IdTransport].BagageEnSoute" @(item.OptionTransportBagageEnSoute == true ? "checked" : "") />
                            </td>
                            <td>
                                <input type="checkbox" name="options[@item.IdTransport].BagageLarge" @(item.OptionTransportBagageLarge == true ? "checked" : "") />
                            </td>
                            <td>
                                <input type="checkbox" name="options[@item.IdTransport].Speedyboarding" @(item.OptionTransportSpeedyboarding == true ? "checked" : "") />
                            </td>
                            <td>@item.PrixTransportPrix</td>
                        }
                        else if (selectedCategory == "Terrestre - Voiture")
                        {
                            <td>@item.VehiculeLocMarque</td>
                            <td>@item.VehiculeLocTypeVehicule</td>
                            <td>@item.VehiculeLocNbSiege</td>
                            <td>@item.PrixTransportPrix</td>
                        }
                        else if (selectedCategory == "Cyclable")
                        {
                            <td>@item.PrixTransportPrix</td>
                        }
                    </tr>
                }
            </tbody>
        </table>

        <button type="submit" class="btn btn-primary">Confirmer et passer à la réservation de logement</button>
    </form>
}

<!-- Form to skip transport selection and proceed to lodging -->
<form method="post" asp-action="ProceedToLodging">
    @Html.AntiForgeryToken()
    <button type="submit" class="btn btn-secondary">Passer à la réservation de logement sans sélectionner de transport</button>
</form>